---
title:  "(TIL) 딥러닝 - 10. RNN을 이용한 텍스트 분류(Text Classification)"
excerpt: " 10. RNN을 이용한 텍스트 분류(Text Classification)
텍스트 분류(Text Classification): 텍스트가 어떤 종류의 범주에 속하는지 구분하는 작업    
예시) 영화 리뷰와 같은 텍스트를 입력 받아서 이 리뷰가 긍정 리뷰인지 부정 리뷰인지를 분류하는 '감성 분석',"

categories:
  - Deep Learning
tags:
  - [AI, 딥러닝, 파이썬, 자연어 처리, NLP]

toc: true

last_modified_at: 2025-01-08
thumbnail: ../images/TIL.png
---
![](/images/../images/TIL.png)

# 10. RNN을 이용한 텍스트 분류(Text Classification)
텍스트 분류(Text Classification): 텍스트가 어떤 종류의 범주에 속하는지 구분하는 작업    
예시) 영화 리뷰와 같은 텍스트를 입력 받아서 이 리뷰가 긍정 리뷰인지 부정 리뷰인지를 분류하는 '감성 분석', 입력 받은 텍스트로부터 질문, 명령, 거절 등과 같은 사용자의 의도를 분류하는 '의도 분석' 

## 텍스트 분류 실습
한번 케라스 라이브러리를 이용하여 텍스트 분류를 해보자. 오늘 실습에서는 정답이 있는 데이터로 학습을 하는 지도 학습(Supervised Learning) 방식을 사용할 것이다.

### 임베딩
케라스의 `Embedding()`: 단어 각각에 대해 **정수**로 변환된 입력에 대해서 **임베딩** 작업 수행

단어 각각에 숫자를 맵핑하는 방법으로는 단어를 빈도수 순대로 정렬하고 순차적으로 정수를 부여하는 방법이 있다. 이러게 등장 빈도 순으로 정수를 부여하면, 상위 빈도의 단어만 남기고 등장 빈도수가 적은 단어를 쉽게 제거할 수 있다.

(실습 코드 보기)
----

##  10-05 나이브 베이즈 분류기(Naive Bayes Classifier)
| 메일로부터 토큰화 및 정제 된 단어들 | 분류     |
|----------------------------------|----------|
| me free lottery                 | 스팸 메일 |
| free get free you               | 스팸 메일 |
| you free scholarship            | 정상 메일 |
| free to contact me              | 정상 메일 |
| you won award                   | 정상 메일 |
| you ticket lottery              | 스팸 메일 |


나이브 베이즈 분류기는 인공 신경망 알고리즘에는 속하지 않지만, 머신 러닝의 주요 알고리즘으로 분류에 있어 준수한 성능을 보여줌

- P(정상 메일 | 입력 텍스트) = P(입력 텍스트 | 정상 메일) × P(정상 메일)
- P(스팸 메일 | 입력 텍스트) = P(입력 텍스트 | 스팸 메일) × P(스팸 메일)

나이브 베이즈 분류기에서 토큰화 이전의 단어의 순서는 중요하지 않다. BoW와 같이 오직 빈도수만을 고려함.


![](/images/../images/2025-01-09-18-07-05.png)


### 나이브 베이즈 주의사항
![](/images/../images/2025-01-09-18-09-16.png)

- 입력 텍스트에 대해서 단, 하나의 단어라도 훈련 텍스트에 없었다면 확률 전체가 0이 되는 것은 지나친 일반화
- 정상 메일에 lottery가 단 한 번도 등장하지 않았고, 그 이유로 정상 메일일 확률 자체가 0%가 되어버림
- 이를 방지하기 위해서 나이브 베이즈 분류기에서는 각 단어에 대한 확률의 **분모, 분자에 전부 숫자를 더해서 분자가 0이 되는 것을 방지**하는 **라플라스 스무딩**을 사용하기도 한다.

```py
MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
# alpha=1.0은 라플라스 스무딩이 적용되었음을 의미
```

## 정규 표현식
- 영어의 알파벳들을 나타내는 정규 표현식은 [a-zA-Z]
    - 이 정규 표현식은 영어의 소문자와 대문자들을 모두 포함
    - 이를 응용하면 영어에 속하지 않는 구두점이나 특수문자를 제거할 수 있다.
- 원리를 적용하면 한글의 정규 표현식은 [ㄱ-ㅎㅏ-ㅣ가-힣]