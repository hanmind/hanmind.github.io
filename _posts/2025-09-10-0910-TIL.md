---
title:  "FastAPI의 PUT/PATCH API, Body vs BaseModel 비교"
excerpt: "PUT vs PATCH 차이
### PUT
- 리소스 전체 교체 (replace)
- 요청에서 보낸 데이터로 기존 리소스를 통째로 덮어씀"

categories:
  - TIL
tags:
  - [TIL, FastAPI, PUT, PATCH, Body, BaseModel]

toc: true

last_modified_at: 2025-09-10
---

# FastAPI의 PUT/PATCH API, Body vs BaseModel 비교
## PUT vs PATCH 차이
### PUT
- 리소스 전체 교체 (replace)
- 요청에서 보낸 데이터로 기존 리소스를 통째로 덮어씀
- 예시:    
기존 todo:    
```json
 {"title": "공부하기", "is_done": false}
```

PUT 요청:    
```json
{ "title": "산책하기", "is_done": true }
```    
PUT 요청 → todo는 위 JSON으로 완전히 바뀜

### PATCH
- 리소스 일부 수정 (partial update)
- 요청에서 보낸 데이터만 반영하고 나머지는 유지
- 예시:     
기존 todo:     
```json
 {"title": "공부하기", "is_done": false}
```

PATCH 요청:    
```json
{ "is_done": true }
```    
PATCH 요청 → title은 그대로 "공부하기" 유지, is_done만 true로 바뀜

## `Body(..., embed=True)`
FastAPI에서는 기본적으로 함수 파라미터는 query parameter 로 해석된다.    
예시:    
```py
@app.patch("/todos/{todo_id}")
def update_todo_handler(todo_id: int, is_done: bool):
    ...
```

이렇게 하면 todos/1?is_done=true 처럼 쿼리 파라미터로 받는다.

그런데 우리는 **요청 body(JSON)**에서 값을 받고 싶다. 이럴 경우 Body(...)를 사용한다.

### `Body(...)`
- `...` → 필수(required) 값이라는 뜻 (Pydantic 스타일)
- `Body(...)` → 요청 body에서 값을 읽으라는 뜻

### `embed=True`
- JSON 구조 여부를 결정. True일 경우 JSON 구조의 요청 body 요구

예시:    
```py
is_done: bool = Body(..., embed=True)
```

위와 같이 embed를 True로 설정하면, 요청 body는 아래와 같이 와야 한다.

```json
{
  "is_done": true
}
```

반면 `embed=False` (기본값)라면 요청 body는 그냥 값만 있어야 한다.

```json
true
```

보통 실무에서는 key-value 형태(JSON 객체)로 받기 위해 `embed=True`를 사용한다.

## Body vs BaseModel
### Body
- `from fastapi import Body` 로 가져옴
- 단일 값이나 **간단한 타입(bool, int, str 등)**을 요청 body로 받을 때 사용

예시:    
```py
from fastapi import FastAPI, Body

app = FastAPI()

@app.post("/items/")
def create_item(is_done: bool = Body(..., embed=True)):
    return {"is_done": is_done}
```

요청:    
```json
{ "is_done": true }
```

### BaseModel
- `from pydantic import BaseModel` 로 가져옴
- 여러 필드가 있는 **복잡한 구조(JSON 객체)**를 body로 받을 때 사용

예시:    
```py
from fastapi import FastAPI
from pydantic import BaseModel

class Todo(BaseModel):
    title: str
    is_done: bool

app = FastAPI()

@app.post("/todos/")
def create_todo(todo: Todo):
    return todo
```

요청:    
```json
{
  "title": "공부하기",
  "is_done": false
}
```

따라서     
- 필드가 하나뿐이라면 → `Body(..., embed=True)`를 쓰면 충분하고
- 필드가 여러 개라면 → `BaseModel`로 관리하는 게 깔끔하다.