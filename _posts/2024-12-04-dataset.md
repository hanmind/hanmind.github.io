---
title:  "(TIL) 판다스를 이용한 데이터 전처리"
excerpt: "`sort_values()`: 특정 열의 값을 기준으로 데이터를 오름차순 또는 내림차순으로 정렬"

categories:
  - TIL
tags:
  - [TIL, 내일배움캠프, 스파르타내일배움캠프, AI, 파이썬, 라이브러리, 판다스, 데이터프레임, 정렬, 병합]

toc: true

last_modified_at: 2024-12-04
thumbnail: ../assets/TIL.jpg
---
![](/images/../images/2024-12-04-11-03-02.png)

# 데이터 전처리

## 결측치의 종류
`NaN`: 수치적인 데이터가 없을 때
`None`: 값이 없을 때
판다스는 결국 이 둘을 전부 결측치로 처리하기 떄문에 차이가 크게 없지만, 개념적으로는 차이가 있다.

## 결측치 처리 함수
- `dropna()`: 결측치가 있는 행/열 제거
axis=0: 행 삭제(default)
axis=1: 열 삭제

- `fillna()`: 결측치 채우기
이를 이용해 평균, 중앙값, 최빈값 등으로 결측치를 채울 수 있음.
```py
# '나이' 열의 결측치를 평균값으로 대체
df['나이'] = df['나이'].fillna(df['나이'].mean())
```

- `interpolate()`: 주변 값들을 결측치 기반으로 **보간**. 시간 데이터 다룰 시 특히 유용   
행의 순서에 따라 값이 정렬되어 있어 이에 따라 결측치를 추측할 수 있을 때 사용한다. 

- `apply()`: 결측치를 처리하는 **사용자 정의 함수**
```py
# 예시: '나이'가 결측치일 경우, 기본값으로 18을 채우는 함수
def fill_missing_age(x):
    if pd.isna(x):
        return 18
    return x

df['나이'] = df['나이'].apply(fill_missing_age)
print(df)
```

# 인코딩(Encoding)
- 인코딩: **범주형** 데이터(Categorical Data)를 **수치형** 데이터로 변환하는 과정   
많은 머신러닝 모델은 수치형 데이터만 처리할 수 있기 때문에, 범주형 데이터를 인코딩하는 과정이 중요하다.

## 레이블 인코딩
- 레이블 인코딩: 범주형 데이터를 **순서가 있는 숫자**로 변환. 각 범주에 **고유한 숫자**가 할당된다.
- 주의사항: 범주형 데이터에 **순서가 있을 때** 사용하기 적합하다.  
그렇다면 **순서가 없을 때**라면? => 원핫 인코딩이 좋다 (True/False)

## 원-핫 인코딩(One-Hot Encoding)
- 원-핫 인코딩: 각 범주를 **이진 벡터**로 변환. 
각 범주(category)는 고유한 열을 가지며, 해당하는 열에는 1, 나머지 열에는 0이 할당된다. True/False 개념이라고 보면 된다.
```py
import pandas as pd
from sklearn.preprocessing import LabelEncoder

# 예시 데이터프레임 생성
data = {'과일': ['사과', '바나나', '사과', '오렌지', '바나나']}

# 원-핫 인코딩
df_one_hot = pd.get_dummies(df['과일'], prefix='과일')
print(df_one_hot)
```

결과:
```
   과일_바나나  과일_사과  과일_오렌지
0        0        1        0
1        1        0        0
2        0        1        0
3        0        0        1
4        1        0        0
```

## 순서형 인코딩
- 순서형 인코딩: 순서가 있는 범주형 데이터를 그 순서에 따라 **숫자**로 변환하는 방식   
만족도(낮음, 중간, 높음), 등급(A, B, C) 등 순서가 중요한 경우에 적합하다. 주로 직접 손으로 매핑하는 방법으로 이루어지는 것 같다.
```py
data = {'등급': ['낮음', '중간', '높음', '중간', '높음']}
df = pd.DataFrame(data)

# 순서형 인코딩
order = {'낮음': 1, '중간': 2, '높음': 3}
df['등급_인코딩'] = df['등급'].map(order)
print(df)
```

결과:
```    등급  등급_인코딩
0  낮음       1
1  중간       2
2  높음       3
3  중간       2
4  높음       3
```

# 임베딩(Embedding)
임베딩: 범주형 데이터를 **벡터 공간**에 매핑하여 변환
딥러닝에서 주로 사용되며, 고차원 범주형 데이터에 유용하다. 예를 들어 긴 **텍스트**를 처리하는 상황에 사용한다.

# 오늘의 회고
깃허브 블로그에 이미지 붙여넣기가 상당히 귀찮은 일인데, 이를 간단히 해주는 플러그인을 설치했다!   
[[VS Code Extension] Page Image사용하기](https://x2info.github.io/tools/VSCode-PageImage/)   
{currentFileDir}를 {projectRoot}/images/로 바꿔주었음. 이제 Ctrl+Alt+V만 해주면 보통의 Ctrl+V처럼 이미지를 붙여넣을 수 있다. 앞으로 나도 게시물 풍성하게 만들어야지😊

![](/images/../images/2024-12-04-11-08-15.png)
*크기 줄이는 건 나중에 찾아봐야겠다 ^-^*
